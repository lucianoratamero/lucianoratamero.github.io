<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <base href=/ > <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,{},{}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.311a5b93.js"}catch(e){main="/client/legacy/client.eda691f8.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.4.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> <link href=client/client-a688d852.css rel=stylesheet><link href=client/Icon-dfea4060.css rel=stylesheet> <style>.hljs-comment,.hljs-quote{color:#969896}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d54e53}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#e78c45}.hljs-attribute{color:#e7c547}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#b9ca4a}.hljs-section,.hljs-title{color:#7aa6da}.hljs-keyword,.hljs-selector-tag{color:#c397d8}.hljs{display:block;overflow-x:auto;background:#000;color:#eaeaea;padding:.5em}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><title>Lektor parte 2: deploy, macros, admin e plugins - luciano@ratamero.com</title> <meta content="agora que já expliquei o básico de como utilizar o Lektor pra desenvolver seu site estático, vou começar a explicar alguns aspectos mais avançados. :]" name=description> <meta content="Luciano Ratamero, lektor, python, site estático, deploy, macros, admin, plugins" name=keywords> <meta content="Lektor parte 2: deploy, macros, admin e plugins - luciano@ratamero.com" property=og:title> <meta content="agora que já expliquei o básico de como utilizar o Lektor pra desenvolver seu site estático, vou começar a explicar alguns aspectos mais avançados. :]" property=og:description> <meta content=https://www.ratamero.com/default-media-share.jpg property=og:image> <meta content=https://www.ratamero.com property=og:url> <meta content="Lektor parte 2: deploy, macros, admin e plugins - luciano@ratamero.com" name=twitter:title> <meta content="agora que já expliquei o básico de como utilizar o Lektor pra desenvolver seu site estático, vou começar a explicar alguns aspectos mais avançados. :]" name=twitter:description> <meta content=https://www.ratamero.com/default-media-share.jpg name=twitter:image> <meta content=summary_large_image name=twitter:card> <link href=https://fonts.gstatic.com rel=preconnect> <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400&display=swap" rel=stylesheet> <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono&display=swap" rel=stylesheet> <link href=/client/client.311a5b93.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/client-a688d852.css rel=preload as=style><link href=/client/index.38f77457.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/Icon.06acf308.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/MetaTags.39c5eacd.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/index.ec9d7c60.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js.gz rel=modulepreload as=script crossorigin=use-credentials><link href=/client/Icon-dfea4060.css rel=preload as=style></head> <body> <div id=sapper> <section class="light-theme theme"><section class="loading-overlay svelte-1rtsid8"><div class="circle svelte-gkf9c4" style=--size:60px;--colorInner:#676778;--colorCenter:#40B3FF;--colorOuter:#FF3E00></div></section> <section class=transition-wrapper><main><article class=blog-post> <h1><mark>Lektor parte 2: deploy, macros, admin e plugins</mark></h1> <p class=meta>2016-02-03 </p> <article><figure><a href=https://getlektor.com/ target=_blank><img alt="Lektor's logo" src=/client/7f6171fa788e09ea.png></a></figure> <p>agora que já expliquei o básico de como utilizar o Lektor pra desenvolver seu site estático, vou começar a explicar alguns aspectos mais avançados. não pretendo ser muito detalhista, mas fiquem a vontade para pedir mais informações nos comentários. aí vai! </p> <hr> <h3>deploy</h3> <p>sim, o Lektor vem pronto para uma série de opções para deploy facilitado: <a href=https://www.getlektor.com/docs/deployment/rsync/ >rsync</a>, <a href=https://www.getlektor.com/docs/deployment/ftp/ >ftp</a>, <a href=https://www.getlektor.com/docs/deployment/ghpages/ >github pages</a> e, via plugin, <a href=https://github.com/spenczar/lektor-s3>s3</a>. isso significa que basta ter um local remoto para manter seus arquivos estáticos que você tem um site pronto, com deploy e tudo. </p> <p>o deploy dele é facilmente configurado e bem inteligente, já que ele verifica somente os arquivos que precisam ser alterados e os sobrescreve. para configurar, basta seguir <a href=https://www.getlektor.com/docs/deployment/#lektor-assisted-deployments>a documentação</a> do método escolhido e rodar <code>lektor build lektor deploy</code>. esse processo garante que o Lektor pegará a versão mais nova antes de sincronizar com o servidor. </p> <p>no meu caso, foi só (juro que foi só isso) colocar o seguinte no meu arquivo de projeto, o <code>blog.lektorproject</code>: </p> <pre class=hljs><code><span class=hljs-string>[servers.ghpages]</span></code><br><code><span class=hljs-string>target</span> <span class=hljs-string>=</span> <span class=hljs-string>ghpages+https://lucianoratamero/blog</span></code></pre> <p>não cheguei a ver os outros, mas <strong>duvido</strong> que sejam muito mais complicados que isso. </p> <h3>macros</h3> <p>quando você tiver brincado o suficiente com os modelos do Lektor, você vai sentir falta de iteradores de template. um exemplo clássico é uma página de resumo dos posts de um blog, como a que eu tenho na home desse aqui. </p> <p>pra isso, existem as macros. elas são templates com lógicas embutidas. mais fácil de explicar mostrando um exemplo. </p> <pre class=hljs><code><span class=hljs-template-tag>{% <span class=hljs-name>macro</span> render_blog_post(post, from_index=false) %}</span></code><br><code>  &lt;div class="blog-post"></code><br><code>  <span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>if</span></span> from_index %}</span></code><br><code>    &lt;h2>&lt;a href="<span class=hljs-template-variable>{{ post|url }}</span>"><span class=hljs-template-variable>{{ post.title }}</span>&lt;/a>&lt;/h2></code><br><code>  <span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>else</span></span> %}</span></code><br><code>    &lt;h2><span class=hljs-template-variable>{{ post.title }}</span>&lt;/h2></code><br><code>  <span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>endif</span></span> %}</span></code><br><code>  &lt;p class="meta"></code><br><code>    <span class=hljs-template-variable>{{ post.pub_date }}</span></code><br><code>  &lt;/p></code><br><code>  <span class=hljs-template-variable>{{ post.body }}</span></code><br><code>  &lt;/div></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name>endmacro</span> %}</span></code></pre> <p>o papel dessa macro é receber um objeto <code>post</code> e formatá-lo de acordo com o template. ele é usado pelo template de blog da seguinte forma: </p> <pre class=hljs><code><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>extends</span></span> "layout.html" %}</span></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name>from</span> "macros/blog.html" import render_blog_post %}</span></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name>from</span> "macros/pagination.html" import render_pagination %}</span></code><br><code></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>block</span></span> title %}</span></code><br><code>  <span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>if</span></span> this.title %}</span><span class=hljs-template-variable>{{ this.title }}</span><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>else</span></span> %}</span>olar<span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>endif</span></span> %}</span></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>endblock</span></span> %}</span></code><br><code></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>block</span></span> body %}</span></code><br><code>  <span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>for</span></span> child <span class=hljs-keyword>in</span> this.pagination.items %}</span></code><br><code>    <span class=hljs-template-variable>{{ render_blog_post(child, from_index=true) }}</span></code><br><code>  <span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>endfor</span></span> %}</span></code><br><code></code><br><code>  <span class=hljs-template-variable>{{ render_pagination(this.pagination) }}</span></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>endblock</span></span> %}</span></code></pre> <p>vemos assim que só é necessário importar a macro criada e passar os objetos corretos. pra saber quais objetos e como usá-los, é só dar uma olhada na documentação da <a href=https://www.getlektor.com/docs/api/db/ >API de tratamento de dados</a> do Lektor. </p> <h3>admin</h3> <p>ah, sim, o Lektor, quando usado localmente, oferece uma interface administrativa pra edição e criação de conteúdo. pra usá-la, basta rodar o servidor com <code>lektor server</code>, acessar a página <code>localhost:5000</code> e clicar no ícone do lápis do canto da tela. </p> <a href=/client/3d21ea6f427f981f.jpg><figure><img alt="Mostrando o link do admin no topo direito da tela" src=/client/3d21ea6f427f981f.jpg></figure></a> <p>isso te levará pra uma página do admin similar à essa:</p> <a href=/client/de8110e97a62ab01.jpg><figure><img alt="Exemplo de página de admin" src=/client/de8110e97a62ab01.jpg></figure></a> <p>todas as alterações feitas nela refletirão nos seus arquivos do projeto e vice-versa. fica na sua preferência utilizar a interface administrativa ou editar os arquivos <code>content.lr</code> diretamente. :) mais um pouco e já poderemos colocar isso na mão dos próprios clientes! </p> <h3>plugins</h3> <p>como o Lektor é bem documentado e extensível, ficou fácil pra (pequena) comunidade criar plugins que adicionam novos comportamentos. vocês devem ter notado que uso o disqus como plataforma de comentários, e não tive trabalho quase nenhum pra colocá-lo no blog, quase nenhum <strong>mesmo</strong>. </p> <p>pra usar um plugin, é só procurar na <a href=https://www.getlektor.com/docs/plugins/ >página de plugins do Lektor</a> o plugin que quer usar e seguir a própria documentação. vou demonstrar pra vocês como foi fácil colocar o <a href=https://github.com/lektor/lektor-disqus-comments>plugin de comentários do disqus</a>. </p> <p>o que eu fiz foi abrir o aquivo <code>blog.lektorproject</code> na raiz do meu projeto (o nome do arquivo varia com o nome do projeto) e colocar as seguintes linhas: </p> <pre class=hljs><code><span class=hljs-string>[packages]</span></code><br><code><span class=hljs-string>lektor-disqus-comments</span> <span class=hljs-string>=</span> <span class=hljs-number>0.1</span></code></pre> <p>isso fez com que, quando eu rodasse <code>lektor server</code> ou <code>lektor build</code>, ele detectasse minha intenção, instalasse as dependências e ficasse pronto pra usar o plugin. </p> <p>depois disso, fui no <a href="https://publishers.disqus.com/engage?utm_source=Home-Nav">disqus</a> e criei uma comunidade pro blog (é bem autoexplicativo o processo, não me demorou dois minutos). </p> <p>com o nome da comunidade em mãos, criei uma pasta <code>configs/</code> na raiz do projeto com um arquivo <code>disqus-comments.ini</code> dentro. nesse arquivo, só precisei declarar o shortname da comunidade. </p> <pre><code>shortname = lucianoratamerosblog</code></pre> <p>com o disqus configurado, escolhi o template de blog-post pra habilitar os comentários e os coloquei assim: </p> <pre class=hljs><code><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>extends</span></span> "layout.html" %}</span></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name>from</span> "macros/blog.html" import render_blog_post %}</span></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>block</span></span> title %}</span><span class=hljs-template-variable>{{ this.title }}</span><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>endblock</span></span> %}</span></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>block</span></span> tags %}</span><span class=hljs-template-variable>{{ this.tags }}</span><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>endblock</span></span> %}</span></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>block</span></span> body %}</span></code><br><code>  <span class=hljs-template-variable>{{ render_blog_post(this) }}</span></code><br><code>  &lt;div class="comments"><span class=hljs-template-variable>{{ render_disqus_comments() }}</span>&lt;/div></code><br><code><span class=hljs-template-tag>{% <span class=hljs-name><span class=hljs-name>endblock</span></span> %}</span></code></pre> <p>só precisei botar mesmo a div de comentários. daí foi recarregar a página e voilá, tudo funcionando <strong>lindamente</strong>. </p> <hr> <p>enfim, espero ter abordado um pouco melhor alguns detalhes e features interessantes do Lektor. caso tenham alguma pergunta ou dúvida, só mandarem ver nos comentários. é isso por enquanto, minha gente, vejo vocês na próxima! o/ </article></article></main></section> <nav class=svelte-1kh6syz><ul class=svelte-1kh6syz><li class=svelte-1kh6syz><a href=/ class=svelte-1kh6syz rel=prefetch>about</a></li> <li class=svelte-1kh6syz><a href=blog/page/1 class=svelte-1kh6syz rel=prefetch aria-current=page>blog</a></li> <li class=svelte-1kh6syz><a href=previous-talks class=svelte-1kh6syz rel=prefetch>talks</a></ul> </nav> </section></div> <script> document.addEventListener('readystatechange', function () {
			if (document.readyState === 'interactive') {
				// set theme
				document.getElementsByClassName('theme')[0].classList = window.matchMedia &&
					window.matchMedia("(prefers-color-scheme: dark)").matches
					? "theme dark-theme"
					: "theme light-theme";

				// fix height on chrome mobile
				let vh = window.innerHeight * 0.01;
				// Then we set the value in the --vh custom property to the root of the document
				document.documentElement.style.setProperty("--vh", `${vh}px`);

				const isChrome = navigator.userAgent.indexOf("Chrome") > -1;
				if (isChrome) {
					document.getElementsByClassName("theme")[0].style["min-height"] =
						"calc(var(--vh, 1vh) * 100)";
				}

				// We listen to the resize event
				window.addEventListener("resize", () => {
					// We execute the same script as before
					let vh = window.innerHeight * 0.01;
					document.documentElement.style.setProperty("--vh", `${vh}px`);

					if (isChrome) {
						document.getElementsByClassName("theme")[0].style["min-height"] =
							"calc(var(--vh, 1vh) * 100)";
					}
				});
			}
		}); </script> 