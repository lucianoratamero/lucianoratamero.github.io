<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <base href=/ > <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,{},{}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.311a5b93.js"}catch(e){main="/client/legacy/client.eda691f8.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.4.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> <link href=client/client-a688d852.css rel=stylesheet><link href=client/Icon-dfea4060.css rel=stylesheet> <style>.hljs-comment,.hljs-quote{color:#969896}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d54e53}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#e78c45}.hljs-attribute{color:#e7c547}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#b9ca4a}.hljs-section,.hljs-title{color:#7aa6da}.hljs-keyword,.hljs-selector-tag{color:#c397d8}.hljs{display:block;overflow-x:auto;background:#000;color:#eaeaea;padding:.5em}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><title>#ajudaLuciano - virtualenv e virtualenvwrapper: como eu uso - luciano@ratamero.com</title> <meta content="Aqui vão\n    algumas dicas de como eu uso virtualenv e virtualenvwrapper pra facilitar minha vida como\n    desenvolvedor, principalmente nesse mundo de python 2/3, angular, react, docker e afins. :]" name=description> <meta content="Luciano Ratamero, #ajudaLuciano, virtualenv, virtualenvwrapper" name=keywords> <meta content="#ajudaLuciano - virtualenv e virtualenvwrapper: como eu uso - luciano@ratamero.com" property=og:title> <meta content="Aqui vão\n    algumas dicas de como eu uso virtualenv e virtualenvwrapper pra facilitar minha vida como\n    desenvolvedor, principalmente nesse mundo de python 2/3, angular, react, docker e afins. :]" property=og:description> <meta content=https://www.ratamero.com/default-media-share.jpg property=og:image> <meta content=https://www.ratamero.com property=og:url> <meta content="#ajudaLuciano - virtualenv e virtualenvwrapper: como eu uso - luciano@ratamero.com" name=twitter:title> <meta content="Aqui vão\n    algumas dicas de como eu uso virtualenv e virtualenvwrapper pra facilitar minha vida como\n    desenvolvedor, principalmente nesse mundo de python 2/3, angular, react, docker e afins. :]" name=twitter:description> <meta content=https://www.ratamero.com/default-media-share.jpg name=twitter:image> <meta content=summary_large_image name=twitter:card> <link href=https://fonts.gstatic.com rel=preconnect> <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400&display=swap" rel=stylesheet> <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono&display=swap" rel=stylesheet> <link href=/client/client.311a5b93.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/client-a688d852.css rel=preload as=style><link href=/client/index.5f79f520.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/Icon.06acf308.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/MetaTags.39c5eacd.js rel=modulepreload as=script crossorigin=use-credentials><link href="/client/run-apistar (cópia).b329d67a.js" rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js.gz rel=modulepreload as=script crossorigin=use-credentials><link href=/client/Icon-dfea4060.css rel=preload as=style></head> <body> <div id=sapper> <section class="light-theme theme"><section class="loading-overlay svelte-1rtsid8"><div class="circle svelte-gkf9c4" style=--size:60px;--colorInner:#676778;--colorCenter:#40B3FF;--colorOuter:#FF3E00></div></section> <section class=transition-wrapper><main><article class=blog-post> <h1><mark>#ajudaLuciano - virtualenv e virtualenvwrapper: como eu uso</mark></h1> <p class=meta>2017-12-28 </p> <article><p>como eu sou (pessimamente) conhecido por customizar (demais) meu computador de trabalho com scripts, aliases e o que for, faz um tempo que o pessoal tem me cobrado um post sobre como eu uso virtualenv e virtualenvwrapper. aqui vão algumas dicas de como eu uso ambos pra facilitar minha vida como desenvolvedor, principalmente nesse mundo de python 2/3, angular, react, docker, neo4j e afins. ;) </p> <p><em>for native english speakers, <a href=https://www.ratamero.com/blog/halp-virtualenv-and-virtualenvwrapper/ >here's the translated post</a></em></p> <h3>o que é o virtualenvwrapper</h3> <p>pra quem não conhece, o <a href=https://virtualenvwrapper.readthedocs.io/en/latest/ >virtualenvwrapper</a> é <strong>um conjunto de extensões da virtualenv</strong>. ele provê uma série de comandos úteis pra quem lida com virtualenvs (alguns que eu uso <strong>diariamente</strong>). </p> <p>o virtualenvwrapper funciona da seguinte forma: ele separa suas pastas de projeto das que pertencem à virtualenv, como <code>bin</code>, <code>lib</code>, <code>include</code> e afins, e te dá algumas utilidades. ele coloca as virtualenvs dentro da pasta da variável de ambiente <code>WORKON_HOME</code>. isso é ótimo pra quem gosta de não sujar a pasta do projeto com coisas externas e faz com que você não tenha que colocar as pastas da virtualenv no gitignore, por exemplo. </p> <p>no entanto, eu <strong>pessoalmente</strong> prefiro ter os arquivos de bibliotecas dentro da pasta do projeto por dois motivos: </p> <ul><li>sempre sei onde elas estão sem precisar me lembrar de qual pasta coloquei como <code>WORKON_HOME</code>; </li> <li>e, o melhor, facilito a vida do meu editor de texto, que vai conseguir ler o código das bibliotecas usadas. </ul> <p>isso faz com que, por exemplo, meu editor possa me recomendar nomes de módulos/classes/funções e faça funcionar o lindo "Go To Definition", que abre o local do código-fonte de algum módulo/classe/função que está sendo usada no seu código. tanto o Atom quanto o Sublime têm plugins ótimos pra "Go To Definition", e isso me salvou inúmeras vezes. </p> <figure><a href=/client/03ec815702c570cf.gif><img alt="Vídeo do Go To Definition funcionando" src=/client/03ec815702c570cf.gif></a></figure> <p>então, por motivos argumentativos, vou usar minha preferência pra explicar algumas das minhas decisões. belessa? belessa. </p> <h3><code>workon</code>, <code>cdvirtualenv</code> e outros comandos úteis </h3> <p>o virtualenvwrapper tem uma cacetada de comandos bem úteis pro dia-a-dia do desenvolvedor python, então vou falar sobre os que eu mais uso: </p> <h4><code>workon</code></h4> <p>o <code>workon</code> é um comando que serve pra você ligar sua virtualenv de qualquer lugar. ao executar <code>workon NOMEDOPROJETO</code>, você fica na mesma pasta onde está, mas com todos os parâmetros da sua env, como a versão do python, as bibliotecas instaladas, as variáveis de ambiente e tudo mais. serve como ponto de entrada pra outros hacks que vou destrinchar e aceita <em>tab complete</em>. </p> <h4><code>cdvirtualenv</code></h4> <p>extremamente útil se sua pasta de env e de projeto forem a mesma. o <code>cdvirtualenv</code> te leva diretamente pra raiz da pasta que contém sua env sem que você precise saber qual ela é. se sua pasta de projeto for a mesma, você ganha o bônus de ir diretamente pra pasta do projeto sem precisar dar <code>cd</code> pra ela. faz combo com o <code>workon</code> (novo terminal > <code>workon NOMEDOPROJETO</code> > <code>cdvirtualenv</code>). </p> <figure><a href=/client/a9a73d756cf27c4d.gif><img alt="Vídeo do cdvirtualenv mudando de diretório" src=/client/a9a73d756cf27c4d.gif></a></figure> <h4><code>cpvirtualenv</code></h4> <p>serve pra você replicar uma virtualenv pra outra. pouco usado, mas salvador da pátria quando é. </p> <h4><code>cdsitepackages</code></h4> <p>te leva pra pasta com todas suas bibliotecas instaladas. simples, lindo. </p> <h3>a mágica dos scripts de <code>postactivate</code> e <code>postdeactivate</code></h3> <p>agora que vêm os maiores pulos do gato (pulos dos gatos?): o virtualenvwrapper te dá a opção de você escrever scripts bash pra antes/depois de você ativar uma virtualenv. basta colocar um arquivo chamado <code>postactivate</code> e/ou <code>postdeactivate</code> na pasta <code>bin</code> da sua virtualenv e eles serão executados. </p> <p>isso te permite fazer duas coisas extremamente úteis:</p> <ul><li>exportar/sobrescrever variáveis de ambiente;</li> <li>executar qualquer comando específico do seu projeto.</ul> <p>o primeiro é autoexplicativo, mas o segundo é <strong>lindo demais</strong>; ele faz com que você possa, por exemplo, executar um <code>cdvirtualenv</code> assim que sua env for ativada, te levando direto pra pasta projeto. ou então, melhor ainda, <strong>iniciar dependências externas da sua aplicação/levantar imagens do docker</strong>. ou até fazer com que uma vaquinha diga qual a pasta da sua virtualenv (<code>cowsay $VIRTUAL_ENV</code>). o mesmo pra quando você desativa uma virtualenv (por favor, vamo desligar os treco de docker, né?). enfim, a utilidade é infinita. </p> <figure><a href=/client/d15ea1519b92fcff.gif><img alt="vídeo do postactivate chamando o cowsay" src=/client/d15ea1519b92fcff.gif></a> <a href=/client/b464a0d41ffc5038.gif><img alt="vídeo do postactivate iniciando uma aplicação" src=/client/b464a0d41ffc5038.gif></a></figure> <p>outro ponto interessante é que o virtualenvwrapper cria arquivos globais de todos esses eventos (pré e pós tudo) na sua pasta de virtualenvs. caso esses sejam editados, todas as envs executarão esses scripts quando forem ativadas/desativadas. </p> <p>pra fechar, em alguns dos projetos nos quais eu trabalho, a gente até já convencionou que terão, na pasta <code>contrib</code>, um script de <code>postactivate</code> pronto pra automatizar alguns processos. acaba servindo como documentação de como as coisas funcionam, e tendem a ser bem menos complicados do que dockerfiles, dependendo de pra que são usados. bem maneiro. </p> <hr> <p>enfim, essas foram algumas dicas de como eu automatizo alguns processos chatos usando virtualenv e virtualenvwrapper. espero que tenha sido útil pra vocês, e caso vocês tenham algum hack similar que ajude no desenvolvimento em ambientes python, mandem ver nos comentários! eu vou ficando por aqui. abraços, e até mais o/ </article></article></main></section> <nav class=svelte-1kh6syz><ul class=svelte-1kh6syz><li class=svelte-1kh6syz><a href=/ class=svelte-1kh6syz rel=prefetch>about</a></li> <li class=svelte-1kh6syz><a href=blog/page/1 class=svelte-1kh6syz rel=prefetch aria-current=page>blog</a></li> <li class=svelte-1kh6syz><a href=previous-talks class=svelte-1kh6syz rel=prefetch>talks</a></ul> </nav> </section></div> <script> document.addEventListener('readystatechange', function () {
			if (document.readyState === 'interactive') {
				// set theme
				document.getElementsByClassName('theme')[0].classList = window.matchMedia &&
					window.matchMedia("(prefers-color-scheme: dark)").matches
					? "theme dark-theme"
					: "theme light-theme";

				// fix height on chrome mobile
				let vh = window.innerHeight * 0.01;
				// Then we set the value in the --vh custom property to the root of the document
				document.documentElement.style.setProperty("--vh", `${vh}px`);

				const isChrome = navigator.userAgent.indexOf("Chrome") > -1;
				if (isChrome) {
					document.getElementsByClassName("theme")[0].style["min-height"] =
						"calc(var(--vh, 1vh) * 100)";
				}

				// We listen to the resize event
				window.addEventListener("resize", () => {
					// We execute the same script as before
					let vh = window.innerHeight * 0.01;
					document.documentElement.style.setProperty("--vh", `${vh}px`);

					if (isChrome) {
						document.getElementsByClassName("theme")[0].style["min-height"] =
							"calc(var(--vh, 1vh) * 100)";
					}
				});
			}
		}); </script> 